import{D as t,W as e,y as i,B as s,r as a}from"./cc0f84bb.js";import{p as r,L as l,r as n}from"./39b7cdb0.js";class d{constructor(t){Object.assign(this,t)}}class u{constructor(t){Object.assign(this,t)}}class o extends t{constructor(){super(...arguments),this.items=[],this.types=["page","person","library"]}_parseResults(t){var i;t.data.forEach((e=>{const i=e.attributes.drupal_internal__nid,s=t.meta.extra_data[i];e.meta=s})),this.items=t.data?t.data.map((t=>{return"node--page"===t.type?function(t){var e;return new d({id:t.id,uuid:t.id,title:t.attributes.title,body:null===(e=t.attributes.body)||void 0===e?void 0:e.processed,description:t.meta&&t.meta.excerpt?t.meta.excerpt.replace(/<(\/?)strong>/g,"<$1mark>"):"",path:t.attributes.path.alias,link:`http://library.virginia.edu${t.attributes.path.alias}`})}(t):"node--person"===t.type?new u({id:(e=t).id,uuid:e.id,title:e.attributes.title,name:e.attributes.title,jobTitle:e.attributes.field_uva_ldap_title,description:e.attributes.body?e.attributes.body.processed:"",path:e.attributes.path.alias,link:`http://library.virginia.edu${e.attributes.path.alias}`,computingId:e.attributes.field_computing_id,email:e.attributes.field_uva_ldap_email}):"node--library"===t.type?r(t):{title:t.attributes.title,description:t.attributes.body?t.attributes.body.value:null};var e})):[],this.meta.totalResults=(null===(i=t.data)||void 0===i?void 0:i.meta)?t.data.meta.count:t.meta?t.meta.count:0,this.meta.url=`${e}?search_api_fulltext=${this.query}`}}window.customElements.define("website-section",class extends s{constructor(){super(),this.meta={totalResults:0},this.title="Website",this.websearch=new o}updated(t){super.updated(t),t.has("query")&&(this.loading=!0,this.websearch.query=this.query,this.websearch.fetchData({limit:this.limit}).then((t=>{this.items=t.items,this.meta=t.meta,this.loading=!1})))}renderBriefItem(t){return t instanceof l?n(t):t instanceof u?function(t){return i` <div class="bento-section-title"><a href="${t.link}">${t.title}</a></div> <div class="bento-section-desc">${t.jobTitle}</div> `}(t):a(t)}render(){return i` <style>[hidden]{display:none!important}</style> <div class="bs-results--header"> <h3>${this.title}</h3> <div ?hidden="${!this.isEmptySearch}"><a href="${e}" class="uvalib-button">Search Library website</a></div> <form ?hidden="${this.isEmptySearch}" action="${this.meta.url}" method="get" style="display:inline"> ${this.meta.url&&this.meta.url.indexOf("?")>0?[...new URLSearchParams(this.meta.url.replace(/^.*\?/,""))].map((t=>i` <input type="hidden" name="${t[0]}" value="${t[1]}"> `)):""} <button type="submit" class="uvalib-button">See all <span class="bs-results--qty">${this.meta.totalResults}</span> results</button> </form> </div> <div class="bs-results--body"> <p id="no-results" ?hidden="${!this.isEmptySearch}">${this.noResultDescribe}</p> <p ?hidden="${this.isEmptySearch}">Results from the main Library website.</p> <ol ?hidden="${this.isEmptySearch}" class="bs-results--list"> ${this.items.map((t=>i` <li>${this.renderBriefItem(t)}</li> `))} </ol> </div> `}});

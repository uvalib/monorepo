import{_ as t,e as s,a as i,b as e,y as a}from"./2ce5e5c8.js";import{V as l}from"./7a7ec51d.js";import{B as r}from"./908d7932.js";class h{constructor(t){this.query="",this.limit=5,this.items=[],this.meta={totalResults:0},this.virgoCatalogPoolURL="https://pool-solr-ws-uva-library.internal.lib.virginia.edu/api/search",this.catalogLinkBase="https://search.lib.virginia.edu/sources/uva_library/items",t.query&&(this.query=t.query)}async fetchData(t){return l.fetchData(this.virgoCatalogPoolURL,this.catalogLinkBase,this.query,t&&t.limit?t.limit:this.limit).then((t=>(t.meta.url=`https://search.lib.virginia.edu/?q=${this.query}&pool=uva_library`,this.items=t.items,this.meta=t.meta,t)))}}var o;class u extends r{constructor(){super(),o.set(this,void 0),this.items=[],this.meta={totalResults:0},this.title="Virgo Catalog",i(this,o,new h({query:""}),"f"),this.limit=5}updated(t){super.updated(t),(t.has("query")||t.has("limit"))&&(this.loading=!0,e(this,o,"f").query=this.query,e(this,o,"f").fetchData({limit:this.limit}).then((t=>{this.items=t.items,this.meta=t.meta,this.loading=!1})))}render(){var t,s;return a` <div class="bs-results--header"> <h3>${this.title}</h3> <div ?hidden="${!this.isEmptySearch}"><a href="${null===(s=null===(t=this.meta)||void 0===t?void 0:t.url)||void 0===s?void 0:s.replace(/(.*)\?.*/,"$1")}" class="uvalib-button">Search Virgo</a></div> <form ?hidden="${this.isEmptySearch}" action="${this.meta.url}" method="get" style="display:inline"> ${this.meta.url&&this.meta.url.indexOf("?")>0?[...new URLSearchParams(this.meta.url.replace(/^.*\?/,""))].map((t=>a` <input type="hidden" name="${t[0]}" value="${t[1]}"> `)):""} <button type="submit" class="uvalib-button">See all <span class="bs-results--qty">${this.meta.totalResults}</span> results</button> </form> </div> <div class="bs-results--body"> <p id="no-results" ?hidden="${!this.isEmptySearch}">${this.noResultDescribe}</p> <p ?hidden="${this.isEmptySearch}">Books, journals, manuscripts &amp; archival material, maps, music and sound recordings, theses and dissertations, and videos.</p> <ol ?hidden="${this.isEmptySearch}" class="bs-results--list"> ${this.items.map((t=>a` <li class="bs-results--list--entry"><a href="${t.link?t.link:""}" class="bs-results--title">${t.title}</a> <ul class="ul-0"> ${t.author?a`<li class="bs-results--author li-1">${t.author.join(", ")}</li>`:""} <ul class="ul-1"> ${t.datePublished?a`<li class="bs-results--date li-1">${t.datePublished.toLocaleDateString("en-US")}</li>`:""} ${t.format&&t.format.length>0?a`<li class="bs-results--format li-1" aria-label="${t.format.join("/")}">${t.format.join("/")}</li>`:""} </ul> </ul> </li> `))} </ol> </div> `}}o=new WeakMap,t([s({type:Array})],u.prototype,"items",void 0),window.customElements.define("catalog-section",u);

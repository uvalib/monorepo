import{_ as e,e as t,a as i,b as a,y as n}from"./6b52cb25.js";import{G as s}from"./99b8e92c.js";import{B as r}from"./5fd0613f.js";function o(e,t){if(t.length<e)throw new TypeError(e+" argument"+(e>1?"s":"")+" required, but only "+t.length+" present")}function m(e){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},m(e)}function c(e){o(1,arguments);var t=Object.prototype.toString.call(e);return e instanceof Date||"object"===m(e)&&"[object Date]"===t?new Date(e.getTime()):"number"==typeof e||"[object Number]"===t?new Date(e):("string"!=typeof e&&"[object String]"!==t||"undefined"==typeof console||(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn((new Error).stack)),new Date(NaN))}function l(e){o(1,arguments);var t=c(e);return t.setHours(0,0,0,0),t}function u(e){if(o(1,arguments),"string"==typeof e){var t=e.match(/(\d{4})-(\d{2})-(\d{2})[T ](\d{2}):(\d{2}):(\d{2})(?:\.(\d{0,7}))?(?:Z|(.)(\d{2}):?(\d{2})?)?/);return t?new Date(Date.UTC(+t[1],+t[2]-1,+t[3],+t[4]-(+t[9]||0)*("-"==t[8]?-1:1),+t[5]-(+t[10]||0)*("-"==t[8]?-1:1),+t[6],+((t[7]||"0")+"00").substring(0,3))):new Date(NaN)}return c(e)}function d(e){return{id:e.id,title:e.title,allday:e.allday,start:e.start?u(e.start).getTime():null,end:e.end?u(e.end).getTime():null,description:e.description,link:e.url.public,location:e.location.name,campusLocation:e.campus,category:e.category.name,owner:e.owner.name,calendar:{name:e.calendar.name,url:e.calendar.public},registration:e.registration,registrationOpen:e.has_registration_opened,registrationClosed:e.has_registration_closed,seats:e.seats,seatsTaken:e.seats_taken,physicalSeats:e.physical_seats,physicalSeatsTaken:e.physical_seats_taken,onlineSeats:e.online_seats,onlineSeatsTaken:e.online_seats_taken,waitList:e.wait_list,image:e.featured_image,futureDates:e.future_dates.map((e=>({id:e.event_id,start:u(e.start).getTime()}))),registrationCost:e.registration_cost,moreInfo:e.more_info,setupTime:e.setup_time,teardownTime:e.teardown_time}}class h extends s{constructor(e){super(),this.items=[],Object.assign(this,e)}endpointURL(){let e=this.query?`&search=${this.query}`:"";return e+=this.limit?`&limit=${this.limit}`:"",e+=this.category?`&category=${this.category}`:"",this.query?`https://api2.libcal.com/1.0/event_search?key=c45a1428103ed000ba4025e9970edf54&iid=863&cal_id=4299&limit=600&campus=&category=&days=365${e}`:`https://api2.libcal.com/1.0/events?key=c45a1428103ed000ba4025e9970edf54&iid=863&cal_id=4299&limit=600&campus=&category=&days=365${e}`}async fetchData(){return fetch(this.endpointURL()).then((e=>e.json())).then((e=>(this._parseResults(e),{items:this.items,meta:this.meta})))}_parseResults(e){this.items=e.events.map(d),this.meta.totalResults=e.events.length}}var p;class y extends r{constructor(){super(),this.items=[],p.set(this,void 0),this.title="",i(this,p,new h,"f")}updated(e){super.updated(e),(e.has("query")||e.has("limit")||e.has("category"))&&(this.loading=!0,a(this,p,"f").query=this.query,a(this,p,"f").limit=this.limit,a(this,p,"f").category=this.category,a(this,p,"f").fetchData().then((e=>{this.items=e.items,this.loading=!1})))}_dateRange(e,t){const i=e?new Date(e):new Date,a=t?new Date(t):new Date;return function(e,t){o(2,arguments);var i=l(e),a=l(t);return i.getTime()===a.getTime()}(i,a)?new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric",year:"numeric",timeZone:"America/New_York"}).format(i):`${new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric",timeZone:"America/New_York"}).format(i)} - ${new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric",year:"numeric",timeZone:"America/New_York"}).format(a)}`}_timeRange(e,t){return`${new Intl.DateTimeFormat("en-US",{hour:"numeric",minute:"2-digit",timeZone:"America/New_York"}).format(e)} - ${new Intl.DateTimeFormat("en-US",{hour:"numeric",minute:"2-digit",timeZoneName:"short",timeZone:"America/New_York"}).format(t)}`}render(){return n` ${this.title?n`<h2>${this.title}</h2>`:""} <div class="event-container"> ${this.loading?n`<site-spinner></site-spinner>`:""} ${this.items.map((e=>n` <div class="event"> <a href="${e.link}" class="event-url"> <h4 class="event-title">${e.title}</h4> <p class="event-date">${this._dateRange(e.start,e.end)}</p> <p class="event-time">${this._timeRange(e.start,e.end)}</p> </a> </div> `))} <slot name="see-more"></slot> </div> `}}p=new WeakMap,e([t({type:String})],y.prototype,"category",void 0),e([t({type:Array})],y.prototype,"items",void 0),window.customElements.define("events-section",y);

import{a as t,b as i,y as e}from"./88734cf1.js";import{G as s,D as r}from"./6d813ba9.js";import{B as a}from"./98fe9252.js";class d{setHours(t){this.hours=t}constructor(t){Object.assign(this,t)}}function o(t){var i,e;return new d({id:t.id,uuid:t.id,title:t.attributes.title,body:t.attributes.body.processed,description:t.attributes.body.processed,shortTitle:t.attributes.field_short_title,placeType:t.attributes.field_type_basic,contactForm:t.attributes.field_contact_form,donorDescription:t.attributes.field_donor_description,donorTitle:t.attributes.field_donor_title,emailAddress:t.attributes.field_email_address,hoursInformation:t.attributes.field_hours_information,hoursId:t.attributes.field_libcal_id,libraryFeed:t.attributes.field_library_feed,link:null===(i=t.attributes.field_library_site_link)||void 0===i?void 0:i.uri,siteLink:null===(e=t.attributes.field_library_site_link)||void 0===e?void 0:e.uri,fmKey:t.attributes.field_location_key,location:t.attributes.field_fm_location?{lat:t.attributes.field_fm_location.lat,lng:t.attributes.field_fm_location.lng}:void 0,mygroupId:t.attributes.field_mygroup_id,phoneNumber:t.attributes.field_phone_number,socialMedia:t.attributes.field_social_media?t.attributes.field_social_media.map((t=>({uri:t.uri,title:t.title}))):void 0,slug:t.attributes.field_slug,zipCode:t.attributes.field_zip_code,googleMyBusiness:t.attributes.field_google_my_business,parent:t.attributes.field_parent&&t.attributes.field_parent.data&&t.attributes.field_parent.data.id?t.attributes.field_parent.data.id:void 0,closureOverride:t.attributes.field_closure_override})}class l{constructor(t){Object.assign(this,t)}}class n extends s{constructor(t){super(),this.items=[],this.ids=[],Object.assign(this,t)}async fetchData(){return fetch("https://cal.lib.virginia.edu/api/1.0/hours/[[calIds]]?iid=863&key=e4b27d40b7099e8e392113da2f8bf30a".replace("[[calIds]]",this.ids.join(","))).then((t=>t.json())).then((t=>t.map((t=>function(t){return new l({id:t.lid,title:t.name,description:t.desc,link:t.url,rawDates:t.dates})}(t)))))}}class u extends r{constructor(){super(...arguments),this.type="library",this.items=[]}_parseResults(t){this.items=t.data.map(o)}async fetchHours(){const t=this.items.map((t=>t.hoursId)).filter((t=>null!==t)).map((t=>parseInt(t,10)));return new n({ids:t}).fetchData().then((t=>{this.items.forEach((i=>{i.hoursId&&i.setHours(t.find((t=>parseInt(t.id,10)===parseInt(i.hoursId,10))))}))}))}}var c;function f(t){return e` ${t.link?e` <div class="bento-section-title"><a href="${t.link}">${t.title}</a></div> `:e` <div class="bento-section-title"><a href="http://library.virginia.edu/hours#${t.slug}">${t.title}</a></div> `} <div class="bento-section-desc"></div> `}class b extends a{constructor(){super(),c.set(this,void 0),this.title="Libraries",t(this,c,new u,"f")}updated(t){super.updated(t),t.has("query")&&(this.loading=!0,i(this,c,"f").query=this.query,i(this,c,"f").fetchData().then((()=>{this.items=i(this,c,"f").items,this.loading=!1})))}renderBriefItem(t){return f(t)}}c=new WeakMap;export{d as L,b as a,o as p,f as r};

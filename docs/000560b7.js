import{y as t}from"./e486a950.js";import{D as e,W as i}from"./14b7ebd8.js";import{p as s,L as a,r}from"./11d70e6f.js";import{B as l,r as d}from"./00cd67f3.js";class n{constructor(t){Object.assign(this,t)}}class u{constructor(t){Object.assign(this,t)}}class o extends e{constructor(){super(...arguments),this.items=[],this.types=["page","person","library"]}_parseResults(t){var e;t.data.forEach((e=>{const i=e.attributes.drupal_internal__nid,s=t.meta.extra_data[i];e.meta=s})),this.items=t.data?t.data.map((t=>{return"node--page"===t.type?function(t){var e;return new n({id:t.id,uuid:t.id,title:t.attributes.title,body:null===(e=t.attributes.body)||void 0===e?void 0:e.processed,description:t.meta&&t.meta.excerpt?t.meta.excerpt.replace(/<(\/?)strong>/g,"<$1mark>"):"",path:t.attributes.path.alias,link:`http://library.virginia.edu${t.attributes.path.alias}`})}(t):"node--person"===t.type?new u({id:(e=t).id,uuid:e.id,title:e.attributes.title,name:e.attributes.title,jobTitle:e.attributes.field_uva_ldap_title,description:e.attributes.body?e.attributes.body.processed:"",path:e.attributes.path.alias,link:`http://library.virginia.edu${e.attributes.path.alias}`,computingId:e.attributes.field_computing_id,email:e.attributes.field_uva_ldap_email}):"node--library"===t.type?s(t):{title:t.attributes.title,description:t.attributes.body?t.attributes.body.value:null};var e})):[],this.meta.totalResults=(null===(e=t.data)||void 0===e?void 0:e.meta)?t.data.meta.count:t.meta?t.meta.count:0,this.meta.url=`${i}?search_api_fulltext=${this.query}`}}window.customElements.define("website-section",class extends l{constructor(){super(),this.meta={totalResults:0},this.title="Website",this.websearch=new o}updated(t){super.updated(t),t.has("query")&&(this.loading=!0,this.websearch.query=this.query,this.websearch.fetchData({limit:this.limit}).then((t=>{this.items=t.items,this.meta=t.meta,this.loading=!1})))}renderBriefItem(e){return e instanceof a?r(e):e instanceof u?function(e){return t` <div class="bento-section-title"><a href="${e.link}">${e.title}</a></div> <div class="bento-section-desc">${e.jobTitle}</div> `}(e):d(e)}render(){return t` <style>[hidden]{display:none!important}</style> <div class="bs-results--header"> <h3>${this.title}</h3> <div ?hidden="${!this.isEmptySearch}"><a href="${i}" class="uvalib-button">Search Library website</a></div> <form ?hidden="${this.isEmptySearch}" action="${this.meta.url}" method="get" style="display:inline"> ${this.meta.url&&this.meta.url.indexOf("?")>0?[...new URLSearchParams(this.meta.url.replace(/^.*\?/,""))].map((e=>t` <input type="hidden" name="${e[0]}" value="${e[1]}"> `)):""} <button type="submit" class="uvalib-button">See all <span class="bs-results--qty">${this.meta.totalResults}</span> results</button> </form> </div> <div class="bs-results--body"> <p id="no-results" ?hidden="${!this.isEmptySearch}">${this.noResultDescribe}</p> <p ?hidden="${this.isEmptySearch}">Results from the main Library website.</p> <ol ?hidden="${this.isEmptySearch}" class="bs-results--list"> ${this.items.map((e=>t` <li>${this.renderBriefItem(e)}</li> `))} </ol> </div> `}});

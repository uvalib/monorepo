<?php

/**
 * Implements hook_page_attachments_alter().
 */
function my_module_page_attachments_alter(array &$attachments) {
  // Check if the current page contains a web component/custom element.
  $request = Drupal::request();
  $route_match = Drupal::routeMatch();
  $route_name = $route_match->getRouteName();
  $route_parameters = $route_match->getParameters();
  $response = $route_parameters->get('node')->body->value;

  // Get the version number from the module configuration.
  $config = \Drupal::config('module-loader.settings');
  $version = $config->get('version');

  if (strpos($response, 'my-custom-element') !== FALSE) {
    // Add a script module import to the head of the page response.
    $attachments['#attached']['html_head_link'][] = [
      'rel' => 'modulepreload',
      'href' => "path/to/module-$version.js",
    ];
  }
}

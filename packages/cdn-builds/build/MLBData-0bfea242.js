import{G as e,a as t}from"./ArticlesData-e6785a6b.js";import{G as i}from"./GeneralSearchResult-331b56d5.js";const s="https://mlbib.library.virginia.edu/json/extras.json",r="https://mlbib.library.virginia.edu/json/years.json";class a extends i{constructor(e){super(e)}}class n extends e{constructor(e){super(),this.searchIndex=new t({document:{id:"id",index:["plainText"],store:["title","year","plainText"]}}),this.searchReady=!1,this.items=[],this.ids=[],this.indexes=[],Object.assign(this,e),this.indexes.length||(this.indexes=[s,r]),this.initSearchIndex()}async initSearchIndex(){try{(await Promise.all(this.indexes.map((e=>fetch(e).then((e=>e.json())))))).flat().forEach((e=>{this.searchIndex.add(e)})),this.searchReady=!0}catch(e){console.error("Error initializing search index:",e)}}async fetchData(){return(async()=>{for(;!this.searchReady;)await new Promise((e=>setTimeout(e,100)));const e=this.searchIndex.search(this.query||"",{enrich:!0});if(!e||!e[0]||!e[0].result)return console.warn("No search results found or unexpected result structure."),{items:[],meta:{}};return{items:e[0].result.map((e=>function(e){console.log(e);const t=e.id.match(/^\d+$/)?`https://mlbib.library.virginia.edu/year/${e.id}.html`:e.id.startsWith("anchor")&&e.doc.year?`https://mlbib.library.virginia.edu/${e.id.replace("anchor-",`year/${e.doc.year}.html#`)}`:`https://mlbib.library.virginia.edu/${e.id}.html`;return new a({id:e.id,title:e.doc.title,description:e.doc.plainText,year:e.doc.year,link:t})}(e))),meta:{}}})()}}export{n as M,r as a,a as b,s as m};

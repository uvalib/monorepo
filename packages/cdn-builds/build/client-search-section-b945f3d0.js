import{_ as e,n as t}from"./property-4490ebb8.js";import{D as s}from"./document-77724c06.js";import{B as i,r as o}from"./BentoSection-e700f572.js";import"./unsafe-html-11e6b712.js";import"./SiteStyle-3d98d4f6.js";import"./AccessibleStyles-e1ca487e.js";class n{constructor(){this.filenames=[],this.indexType="flexsearch"}async loadFromString(e){const t=JSON.parse(e);if(this.indexType=t.indexType,this.filenames=t.filenames,"flexsearch"===this.indexType){console.log("document:"),console.log(s),this.index=new s({document:{id:"id",index:["content"],store:["title","year"]}});for(let e in t.index)this.index.import(e,t.index[e])}else if("fuse"===this.indexType){const e=await import("./fuse.esm-5b73a1ca.js");this.index=new e.default(t.index,{keys:["text"]})}}performSearch(e){let t=[];if("flexsearch"===this.indexType){console.log(this.index);const s=this.index.search(e,{enrich:!0});console.log(s),t=s.flatMap((e=>e.result)),console.log(t)}else"fuse"===this.indexType&&(t=this.index.search(e).map((e=>e.refIndex)));return console.log(t),t.map((e=>this.filenames[e.id]))}}class r extends i{constructor(){super(...arguments),this.searchLib=new n,this.catalog=null,this.staticIndexURL="/demo/searchIndex.json",this.staticCatalogURL="/demo/catalog.json",this.loading=!0}async firstUpdated(){try{const e=await fetch(this.staticIndexURL),t=await e.text();await this.searchLib.loadFromString(t),this.catalog=await fetch(this.staticCatalogURL).then((e=>e.json())),this.loading=!1}catch(e){console.error(`Error loading search index: ${e}`),this.loading=!1}}updated(e){super.updated(e),e.has("query")&&this.performSearch()}performSearch(){if(console.log("Attempt a search"),this.query){const e=this.searchLib.performSearch(this.query);this.items=e.map((e=>this.catalog.find((t=>t.url===`/minutes/${e.replace(".md","")}/`))))}else this.items=[]}renderBriefItem(e){return console.log(e),o(e?{link:`${e.url}index.html`,title:e.title,description:e.description}:{link:"",title:"",description:""})}render(){return super.render()}}e([t({type:Boolean})],r.prototype,"loading",void 0),window.customElements.define("client-search-section",r);

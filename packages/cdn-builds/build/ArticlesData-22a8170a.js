import{_ as __decorate,n}from"./query-assigned-elements-8ef6cca7.js";import{s}from"./lit-element-9e1ac43c.js";function parse_option(t,e){return void 0===t?e:t}function create_object_array(t){const e=Array(t);for(let i=0;i<t;i++)e[i]=create_object();return e}function get_keys(t){return Object.keys(t)}function create_object(){return Object.create(null)}function concat(t){return[].concat.apply([],t)}function sort_by_length_down(t,e){return e.length-t.length}function is_array(t){return t.constructor===Array}function is_string(t){return"string"==typeof t}function is_object(t){return"object"==typeof t}function is_function(t){return"function"==typeof t}function pipeline(t,e,i,r){if(t&&(e&&(t=replace(t,e)),this.matcher&&(t=replace(t,this.matcher)),this.stemmer&&1<t.length&&(t=replace(t,this.stemmer)),r&&1<t.length&&(t=collapse(t)),i||""===i)){const e=t.split(i);return this.filter?filter(e,this.filter):e}return t}const regex_whitespace=/[\p{Z}\p{S}\p{P}\p{C}]+/u;function init_filter(t){const e=create_object();for(let i=0,r=t.length;i<r;i++)e[t[i]]=1;return e}function init_stemmer_or_matcher(t,e){const i=get_keys(t),r=i.length,s=[];let n="",o=0;for(let a,c,l=0;l<r;l++)a=i[l],c=t[a],c?(s[o++]=regex(e?"(?!\\b)"+a+"(\\b|_)":a),s[o++]=c):n+=(n?"|":"")+a;return n&&(s[o++]=regex(e?"(?!\\b)("+n+")(\\b|_)":"("+n+")"),s[o]=""),s}function replace(t,e){for(let i=0,r=e.length;i<r&&(t=t.replace(e[i],e[i+1]));i+=2);return t}function regex(t){return new RegExp(t,"g")}function collapse(t){let e="",i="";for(let r,s=0,n=t.length;s<n;s++)(r=t[s])!==i&&(e+=i=r);return e}function filter(t,e){const i=t.length,r=[];for(let s=0,n=0;s<i;s++){const i=t[s];i&&!e[i]&&(r[n++]=i)}return r}function encode(t){return pipeline.call(this,(""+t).toLowerCase(),!1,regex_whitespace,!1)}const global_lang={},global_charset={};function apply_async(t){register$1(t,"add"),register$1(t,"append"),register$1(t,"search"),register$1(t,"update"),register$1(t,"remove")}function register$1(t,e){t[e+"Async"]=function(){const t=this,i=arguments,r=i[i.length-1];let s;is_function(r)&&(s=r,delete i[i.length-1]);const n=new Promise((function(r){setTimeout((function(){t.async=!0;const s=t[e].apply(t,i);t.async=!1,r(s)}))}));return s?(n.then(s),this):n}}function intersect(t,e,i,r){const s=t.length;let n,o,a=[],c=0;r&&(r=[]);for(let l=s-1;0<=l;l--){const h=t[l],u=h.length,f=create_object();let p=!n;for(let t=0;t<u;t++){const u=h[t],d=u.length;if(d)for(let t,h,g=0;g<d;g++)if(h=u[g],n){if(n[h]){if(!l)if(i)i--;else if(a[c++]=h,c===e)return a;(l||r)&&(f[h]=1),p=!0}if(r&&(t=(o[h]||0)+1,o[h]=t,t<s)){const e=r[t-2]||(r[t-2]=[]);e[e.length]=h}}else f[h]=1}if(r)n||(o=f);else if(!p)return[];n=f}if(r)for(let t,s,o=r.length-1;0<=o;o--){t=r[o],s=t.length;for(let r,o=0;o<s;o++)if(r=t[o],!n[r]){if(i)i--;else if(a[c++]=r,c===e)return a;n[r]=1}}return a}function intersect_union(t,e){const i=create_object(),r=create_object(),s=[];for(let e=0;e<t.length;e++)i[t[e]]=1;for(let t,n=0;n<e.length;n++){t=e[n];for(let e,n=0;n<t.length;n++)e=t[n],i[e]&&!r[e]&&(r[e]=1,s[s.length]=e)}return s}function CacheClass(t){this.limit=!0!==t&&t,this.cache=create_object(),this.queue=[]}function searchCache(t,e,i){is_object(t)&&(t=t.query);let r=this.cache.get(t);return r||(r=this.search(t,e,i),this.cache.set(t,r)),r}CacheClass.prototype.set=function(t,e){if(!this.cache[t]){let e=this.queue.length;e===this.limit?delete this.cache[this.queue[e-1]]:e++;for(let t=e-1;0<t;t--)this.queue[t]=this.queue[t-1];this.queue[0]=t}this.cache[t]=e},CacheClass.prototype.get=function(t){const e=this.cache[t];if(this.limit&&e){const e=this.queue.indexOf(t);if(e){const t=this.queue[e-1];this.queue[e-1]=this.queue[e],this.queue[e]=t}}return e},CacheClass.prototype.del=function(t){for(let e,i,r=0;r<this.queue.length;r++)i=this.queue[r],e=this.cache[i],e.includes(t)&&(this.queue.splice(r--,1),delete this.cache[i])};const preset={memory:{charset:"latin:extra",resolution:3,minlength:4,fastupdate:!1},performance:{resolution:3,minlength:3,optimize:!1,context:{depth:2,resolution:1}},match:{charset:"latin:extra",tokenize:"reverse"},score:{charset:"latin:advanced",resolution:20,minlength:3,context:{depth:3,resolution:9}},default:{}};function apply_preset(t){if(is_string(t))t=preset[t];else{const e=t.preset;e&&(t=Object.assign({},e[e],t))}return t}function async(t,e,i,r,s,n,o){setTimeout((function(){const a=t(i?i+"."+r:r,JSON.stringify(o));a&&a.then?a.then((function(){e.export(t,e,i,s,n+1)})):e.export(t,e,i,s,n+1)}))}function exportIndex(t,e,i,r,s){let n,o;switch(s||(s=0)){case 0:if(n="reg",this.fastupdate)for(let t in o=create_object(),this.register)o[t]=1;else o=this.register;break;case 1:n="cfg",o={doc:0,opt:this.optimize?1:0};break;case 2:n="map",o=this.map;break;case 3:n="ctx",o=this.ctx;break;default:return}return async(t,e||this,i,n,r,s,o),!0}function importIndex(t,e){e&&(is_string(e)&&(e=JSON.parse(e)),"cfg"===t?this.optimize=!!e.opt:"reg"===t?(this.fastupdate=!1,this.register=e):"map"===t?this.map=e:"ctx"===t&&(this.ctx=e))}function exportDocument(t,e,i,r,s){if(s||(s=0),r||(r=0),r<this.field.length){const i=this.field[r],n=this.index[i];e=this,setTimeout((function(){n.export(t,e,s?i:"",r,s++)||(r++,s=1,e.export(t,e,i,r,s))}))}else{let e,n;switch(s){case 1:e="tag",n=this.tagindex;break;case 2:e="store",n=this.store;break;default:return}async(t,this,i,e,r,s,n)}}function importDocument(t,e){if(e)switch(is_string(e)&&(e=JSON.parse(e)),t){case"tag":this.tagindex=e;break;case"reg":this.fastupdate=!1,this.register=e;for(let t,i=0;i<this.field.length;i++)t=this.index[this.field[i]],t.register=e,t.fastupdate=!1;break;case"store":this.store=e;break;default:const i=(t=t.split("."))[0];t=t[1],i&&t&&this.index[i].import(t,e)}}function Index(t,e){if(!(this instanceof Index))return new Index(t);let i,r,s;t?(i=(t=apply_preset(t)).charset,r=t.lang,is_string(i)&&(-1===i.indexOf(":")&&(i+=":default"),i=global_charset[i]),is_string(r)&&(r=global_lang[r])):t={};let n,o,a=t.context||{};this.encode=t.encode||i&&i.encode||encode,this.register=e||create_object(),this.resolution=n=t.resolution||9,this.tokenize=s=i&&i.tokenize||t.tokenize||"strict",this.depth="strict"===s&&a.depth,this.bidirectional=parse_option(a.bidirectional,!0),this.optimize=o=parse_option(t.optimize,!0),this.fastupdate=parse_option(t.fastupdate,!0),this.minlength=t.minlength||1,this.boost=t.boost,this.map=o?create_object_array(n):create_object(),this.resolution_ctx=n=a.resolution||1,this.ctx=o?create_object_array(n):create_object(),this.rtl=i&&i.rtl||t.rtl,this.matcher=(s=t.matcher||r&&r.matcher)&&init_stemmer_or_matcher(s,!1),this.stemmer=(s=t.stemmer||r&&r.stemmer)&&init_stemmer_or_matcher(s,!0),this.filter=(s=t.filter||r&&r.filter)&&init_filter(s),this.cache=(s=t.cache)&&new CacheClass(s)}function get_score(t,e,i,r,s){return i&&1<t?e+(r||0)<=t?i+(s||0):0|(t-1)/(e+(r||0))*(i+(s||0))+1:0}function single_result(t,e,i){return t=1===t.length?t[0]:concat(t),i||t.length>e?t.slice(i,i+e):t}function get_array(t,e,i,r){if(i){const s=r&&e>i;t=(t=t[s?e:i])&&t[s?i:e]}else t=t[e];return t}function remove_index(t,e,i,r,s){let n=0;if(is_array(t))if(s){const i=t.indexOf(e);-1===i?n++:1<t.length&&(t.splice(i,1),n++)}else{s=Math.min(t.length,i);for(let o,a=0;a<s;a++)o=t[a],o&&(n=remove_index(o,e,i,r,s),!r&&!n&&delete t[a])}else for(let o in t)n=remove_index(t[o],e,i,r,s),n||delete t[o];return n}function handler(t){t=t.data;const e=self._index,i=t.args,r=t.task;if("init"===r){const e=t.options||{},i=t.factory,r=e.encode;e.cache=!1,r&&0===r.indexOf("function")&&(e.encode=Function("return "+r)()),i?(Function("return "+i)()(self),self._index=new self.FlexSearch.Index(e),delete self.FlexSearch):self._index=new Index(e)}else{const s=t.id,n=e[r].apply(e,i);postMessage("search"===r?{id:s,msg:n}:{id:s})}}Index.prototype.append=function(t,e){return this.add(t,e,!0)},Index.prototype.add=function(t,e,i,r){if(e&&(t||0===t)){if(!r&&!i&&this.register[t])return this.update(t,e);const s=(e=this.encode(""+e)).length;if(s){const r=create_object(),n=create_object(),o=this.depth,a=this.resolution;for(let c=0;c<s;c++){let l=e[this.rtl?s-1-c:c],h=l.length;if(l&&h>=this.minlength&&(o||!n[l])){let u=get_score(a,s,c),f="";switch(this.tokenize){case"full":if(2<h){for(let e=0;e<h;e++)for(let r=h;r>e;r--)if(r-e>=this.minlength){const o=get_score(a,s,c,h,e);f=l.substring(e,r),this.push_index(n,f,o,t,i)}break}case"reverse":if(1<h){for(let e=h-1;0<e;e--)if(f=l[e]+f,f.length>=this.minlength){const r=get_score(a,s,c,h,e);this.push_index(n,f,r,t,i)}f=""}case"forward":if(1<h){for(let e=0;e<h;e++)f+=l[e],f.length>=this.minlength&&this.push_index(n,f,u,t,i);break}default:if(this.boost&&(u=Math.min(0|u/this.boost(e,l,c),a-1)),this.push_index(n,l,u,t,i),o&&1<s&&c<s-1){const n=create_object(),a=this.resolution_ctx,h=l,u=Math.min(o+1,s-c);n[h]=1;for(let o=1;o<u;o++)if(l=e[this.rtl?s-1-c-o:c+o],l&&l.length>=this.minlength&&!n[l]){n[l]=1;const e=get_score(a+(s/2>a?0:1),s,c,u-1,o-1),f=this.bidirectional&&l>h;this.push_index(r,f?h:l,e,t,i,f?l:h)}}}}}this.fastupdate||(this.register[t]=1)}}return this},Index.prototype.push_index=function(t,e,i,r,s,n){let o=n?this.ctx:this.map;if((!t[e]||n&&!t[e][n])&&(this.optimize&&(o=o[i]),n?((t=t[e]||(t[e]=create_object()))[n]=1,o=o[n]||(o[n]=create_object())):t[e]=1,o=o[e]||(o[e]=[]),this.optimize||(o=o[i]||(o[i]=[])),(!s||!o.includes(r))&&(o[o.length]=r,this.fastupdate))){const t=this.register[r]||(this.register[r]=[]);t[t.length]=o}},Index.prototype.search=function(t,e,i){i||(!e&&is_object(t)?t=(i=t).query:is_object(e)&&(i=e));let r,s,n,o=[],a=0;if(i&&(t=i.query||t,e=i.limit,a=i.offset||0,s=i.context,n=i.suggest),t&&(r=(t=this.encode(""+t)).length,1<r)){const e=create_object(),i=[];for(let s,a=0,c=0;a<r;a++)if(s=t[a],s&&s.length>=this.minlength&&!e[s]){if(!this.optimize&&!n&&!this.map[s])return o;i[c++]=s,e[s]=1}r=(t=i).length}if(!r)return o;e||(e=100);let c,l=this.depth&&1<r&&!1!==s,h=0;l?(c=t[0],h=1):1<r&&t.sort(sort_by_length_down);for(let i,s;h<r;h++){if(s=t[h],l?(i=this.add_result(o,n,e,a,2===r,s,c),(!n||!1!==i||!o.length)&&(c=s)):i=this.add_result(o,n,e,a,1===r,s),i)return i;if(n&&h==r-1){let t=o.length;if(!t){if(l){l=0,h=-1;continue}return o}if(1===t)return single_result(o[0],e,a)}}return intersect(o,e,a,n)},Index.prototype.add_result=function(t,e,i,r,s,n,o){let a=[],c=o?this.ctx:this.map;if(this.optimize||(c=get_array(c,n,o,this.bidirectional)),c){let e=0;const l=Math.min(c.length,o?this.resolution_ctx:this.resolution);for(let t,h,u=0,f=0;u<l&&(t=c[u],!(t&&(this.optimize&&(t=get_array(t,n,o,this.bidirectional)),r&&t&&s&&(h=t.length,h<=r?(r-=h,t=null):(t=t.slice(r),r=0)),t&&(a[e++]=t,s&&(f+=t.length,f>=i)))));u++);if(e)return s?single_result(a,i,0):void(t[t.length]=a)}return!e&&a},Index.prototype.contain=function(t){return!!this.register[t]},Index.prototype.update=function(t,e){return this.remove(t).add(t,e)},Index.prototype.remove=function(t,e){const i=this.register[t];if(i){if(this.fastupdate)for(let e,r=0;r<i.length;r++)e=i[r],e.splice(e.indexOf(t),1);else remove_index(this.map,t,this.resolution,this.optimize),this.depth&&remove_index(this.ctx,t,this.resolution_ctx,this.optimize);e||delete this.register[t],this.cache&&this.cache.del(t)}return this},Index.prototype.searchCache=searchCache,Index.prototype.export=exportIndex,Index.prototype.import=importIndex,apply_async(Index.prototype);let pid=0;function WorkerIndex(t){if(!(this instanceof WorkerIndex))return new WorkerIndex(t);let e;t?is_function(e=t.encode)&&(t.encode=e.toString()):t={};let i=(self||window)._factory;i&&(i=i.toString());const r="undefined"==typeof window&&self.exports,s=this;this.worker=create(i,r,t.worker),this.resolver=create_object(),this.worker&&(r?this.worker.on("message",(function(t){s.resolver[t.id](t.msg),delete s.resolver[t.id]})):this.worker.onmessage=function(t){t=t.data,s.resolver[t.id](t.msg),delete s.resolver[t.id]},this.worker.postMessage({task:"init",factory:i,options:t}))}function register(t){WorkerIndex.prototype[t]=WorkerIndex.prototype[t+"Async"]=function(){const e=this,i=[].slice.call(arguments),r=i[i.length-1];let s;is_function(r)&&(s=r,i.splice(i.length-1,1));const n=new Promise((function(r){setTimeout((function(){e.resolver[++pid]=r,e.worker.postMessage({task:t,id:pid,args:i})}))}));return s?(n.then(s),this):n}}function create(factory,is_node_js,worker_path){let worker;try{worker=is_node_js?eval('new (require("worker_threads")["Worker"])("../dist/node/node.js")'):factory?new Worker(URL.createObjectURL(new Blob(["onmessage="+handler.toString()],{type:"text/javascript"}))):new Worker(is_string(worker_path)?worker_path:"worker/worker.js",{type:"module"})}catch(t){}return worker}function Document(t){if(!(this instanceof Document))return new Document(t);const e=t.document||t.doc||t;let i;this.tree=[],this.field=[],this.marker=[],this.register=create_object(),this.key=(i=e.key||e.id)&&parse_tree(i,this.marker)||"id",this.fastupdate=parse_option(t.fastupdate,!0),this.storetree=(i=e.store)&&!0!==i&&[],this.store=i&&create_object(),this.tag=(i=e.tag)&&parse_tree(i,this.marker),this.tagindex=i&&create_object(),this.cache=(i=t.cache)&&new CacheClass(i),t.cache=!1,this.worker=t.worker,this.async=!1,this.index=parse_descriptor.call(this,t,e)}function parse_descriptor(t,e){const i=create_object();let r=e.index||e.field||e;is_string(r)&&(r=[r]);for(let e,s,n=0;n<r.length;n++)e=r[n],is_string(e)||(s=e,e=e.field),s=is_object(s)?Object.assign({},t,s):t,this.worker&&(i[e]=new WorkerIndex(s),!i[e].worker&&(this.worker=!1)),this.worker||(i[e]=new Index(s,this.register)),this.tree[n]=parse_tree(e,this.marker),this.field[n]=e;if(this.storetree){let t=e.store;is_string(t)&&(t=[t]);for(let e=0;e<t.length;e++)this.storetree[e]=parse_tree(t[e],this.marker)}return i}function parse_tree(t,e){const i=t.split(":");let r=0;for(let s=0;s<i.length;s++)0<=(t=i[s]).indexOf("[]")&&((t=t.substring(0,t.length-2))&&(e[r]=!0)),t&&(i[r++]=t);return r<i.length&&(i.length=r),1<r?i:i[0]}function parse_simple(t,e){if(is_string(e))t=t[e];else for(let i=0;t&&i<e.length;i++)t=t[e[i]];return t}function store_value(t,e,i,r,s){if(t=t[s],r===i.length-1)e[s]=t;else if(t)if(is_array(t)){e=e[s]=Array(t.length);for(let s=0;s<t.length;s++)store_value(t,e,i,r,s)}else e=e[s]||(e[s]=create_object()),s=i[++r],store_value(t,e,i,r,s)}function add_index(t,e,i,r,s,n,o,a){if(t=t[o])if(r===e.length-1){if(is_array(t)){if(i[r]){for(let e=0;e<t.length;e++)s.add(n,t[e],!0,!0);return}t=t.join(" ")}s.add(n,t,a,!0)}else if(is_array(t))for(let o=0;o<t.length;o++)add_index(t,e,i,r,s,n,o,a);else o=e[++r],add_index(t,e,i,r,s,n,o,a)}function get_tag(t,e,i,r){let s=this.tagindex[t],n=s&&s.length-i;if(n&&0<n)return(n>e||i)&&(s=s.slice(i,i+e)),r&&(s=apply_enrich.call(this,s)),{tag:t,result:s}}function apply_enrich(t){const e=Array(t.length);for(let i,r=0;r<t.length;r++)i=t[r],e[r]={id:i,doc:this.store[i]};return e}register("add"),register("append"),register("search"),register("update"),register("remove"),Document.prototype.add=function(t,e,i){if(is_object(t)&&(t=parse_simple(e=t,this.key)),e&&(t||0===t)){if(!i&&this.register[t])return this.update(t,e);for(let r,s,n=0;n<this.field.length;n++)s=this.field[n],r=this.tree[n],is_string(r)&&(r=[r]),add_index(e,r,this.marker,0,this.index[s],t,r[0],i);if(this.tag){let r=parse_simple(e,this.tag),s=create_object();is_string(r)&&(r=[r]);for(let e,n,o=0;o<r.length;o++)if(e=r[o],!s[e]&&(s[e]=1,n=this.tagindex[e]||(this.tagindex[e]=[]),(!i||!n.includes(t))&&(n[n.length]=t,this.fastupdate))){const e=this.register[t]||(this.register[t]=[]);e[e.length]=n}}if(this.store&&(!i||!this.store[t])){let i;if(this.storetree){i=create_object();for(let t,r=0;r<this.storetree.length;r++)t=this.storetree[r],is_string(t)?i[t]=e[t]:store_value(e,i,t,0,t[0])}this.store[t]=i||e}}return this},Document.prototype.append=function(t,e){return this.add(t,e,!0)},Document.prototype.update=function(t,e){return this.remove(t).add(t,e)},Document.prototype.remove=function(t){if(is_object(t)&&(t=parse_simple(t,this.key)),this.register[t]){for(let e=0;e<this.field.length&&(this.index[this.field[e]].remove(t,!this.worker),!this.fastupdate);e++);if(this.tag&&!this.fastupdate)for(let e in this.tagindex){const i=this.tagindex[e],r=i.indexOf(t);-1!==r&&(1<i.length?i.splice(r,1):delete this.tagindex[e])}this.store&&delete this.store[t],delete this.register[t]}return this},Document.prototype.search=function(t,e,i,r){i||(!e&&is_object(t)?(i=t,t=""):is_object(e)&&(i=e,e=0));let s,n,o,a,c,l,h=[],u=[],f=0;if(i)if(is_array(i))o=i,i=null;else{if(t=i.query||t,s=i.pluck,o=s||i.index||i.field,a=i.tag,n=this.store&&i.enrich,c="and"===i.bool,e=i.limit||e||100,l=i.offset||0,a&&(is_string(a)&&(a=[a]),!t)){for(let t,i=0;i<a.length;i++)t=get_tag.call(this,a[i],e,l,n),t&&(h[h.length]=t,f++);return f?h:[]}is_string(o)&&(o=[o])}o||(o=this.field),c=c&&(1<o.length||a&&1<a.length);const p=!r&&(this.worker||this.async)&&[];for(let s,n,d,g=0;g<o.length;g++){let m;if(n=o[g],is_string(n)||(m=n,n=m.field,t=m.query||t,e=m.limit||e),p)p[g]=this.index[n].searchAsync(t,e,m||i);else{if(s=r?r[g]:this.index[n].search(t,e,m||i),d=s&&s.length,a&&d){const t=[];let i=0;c&&(t[0]=[s]);for(let e,r,s=0;s<a.length;s++)e=a[s],r=this.tagindex[e],d=r&&r.length,d&&(i++,t[t.length]=c?[r]:r);i&&(s=c?intersect(t,e||100,l||0):intersect_union(s,t),d=s.length)}if(d)u[f]=n,h[f++]=s;else if(c)return[]}}if(p){const r=this;return new Promise((function(s){Promise.all(p).then((function(n){s(r.search(t,e,i,n))}))}))}if(!f)return[];if(s&&(!n||!this.store))return h[0];for(let t,e=0;e<u.length;e++){if(t=h[e],t.length&&n&&(t=apply_enrich.call(this,t)),s)return t;h[e]={field:u[e],result:t}}return h},Document.prototype.contain=function(t){return!!this.register[t]},Document.prototype.get=function(t){return this.store[t]},Document.prototype.set=function(t,e){return this.store[t]=e,this},Document.prototype.searchCache=searchCache,Document.prototype.export=exportDocument,Document.prototype.import=importDocument,apply_async(Document.prototype);class GeneralData{constructor(t){this.items=[],this.meta={totalResults:0},this.limit=100,this.fetchRetries=3,this.fetchDelay=1e3,Object.assign(this,t)}async fetchData(){return this.items=[],Promise.resolve({items:this.items,meta:this.meta})}async fetchWithRetry(t,e={}){return this.retry((async()=>{const i=await fetch(t,e);if(!i.ok)throw new Error(i.statusText);return i}))}async retry(t,e=1){try{return await t()}catch(i){if(e<this.fetchRetries)return await new Promise((t=>setTimeout(t,this.fetchDelay))),this.retry(t,e+1);throw i}}}class DataWrap extends s{constructor(){super(...arguments),this.auto=!1}fetchResults(){if(this.url){const t=new URL(this.url);if(this.params)for(const[e,i]of Object.entries(this.params))t.searchParams.set(e,i);fetch(t.toString()).then((t=>t.json())).then((t=>{this.lastResponse=t})),this.poll&&setTimeout((()=>{this.fetchResults()}),this.poll)}}updated(t){this.auto&&(t.has("auto")||t.has("url")||t.has("params")||t.has("poll"))&&this.fetchResults(),this.lastResponse&&this.dispatchEvent(new Event("response",{bubbles:!0,composed:!0}))}}__decorate([n({type:Boolean})],DataWrap.prototype,"auto",void 0),__decorate([n({type:String})],DataWrap.prototype,"url",void 0),__decorate([n({type:Object})],DataWrap.prototype,"params",void 0),__decorate([n({type:Number,attribute:"debounce-duration"})],DataWrap.prototype,"debounceDuration",void 0),__decorate([n({type:Number})],DataWrap.prototype,"poll",void 0),__decorate([n({type:Object})],DataWrap.prototype,"lastResponse",void 0);class VirgoUtils{static async guestAuthToken(){const t=await fetch(this.authURL,{method:"POST"}).then((t=>t.text()));return void 0!==t?`Bearer ${t}`:""}static async fetchData(t,e,i,r=5){const s={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json;charset=UTF-8",Authorization:await VirgoUtils.guestAuthToken()},body:JSON.stringify({query:`keyword: {${void 0===i?"":i}}`,pagination:{start:0,rows:r},sort:{sort_id:"SortRelevance",order:"desc"},filters:[{pool_id:"uva_library",facets:[]}]})};try{const i=await fetch(t,s);if(!i.ok)throw new Error(`Error fetching data: ${i.statusText}`);const r=await i.json();return VirgoUtils.parseResults(e,r)}catch(t){return console.error(`Error in fetchData: ${t.message}`),{items:[],meta:{totalResults:0}}}}static parseResults(t,{group_list:e=[],pagination:i={}}){return{items:e.map((e=>{var i,r;if(1===e.count){const s=e.record_list[0],n=null===(i=s.fields.find((t=>"identifier"===t.type)))||void 0===i?void 0:i.value,o=n?`${t}/${n}`:void 0,a=s.fields.find((t=>"published_date"===t.name)),c=a?new Date(Date.UTC.apply(null,a.value.split("-"))):void 0,l=this.truncateAuthors(s.fields.filter((t=>"author"===t.type)));return{id:n,title:null===(r=s.fields.find((t=>"title"===t.type)))||void 0===r?void 0:r.value,description:"",link:o,author:l,datePublished:c,publicationType:s.fields.filter((t=>"pub_type"===t.name)).map((t=>t.value)),format:s.fields.filter((t=>"format"===t.name)).map((t=>t.value))}}return null})).filter((t=>null!==t)),meta:{totalResults:i?i.total:0}}}static truncateAuthors(t){let e=t.map((t=>t.value));if(e.length>5){const t=e.length-5;e=e.slice(0,5).concat(`and ${t} more`)}return e}}VirgoUtils.authURL="https://search.lib.virginia.edu/authorize";class CatalogData extends GeneralData{constructor(){super(...arguments),this.items=[]}async fetchData(t){var e;const i=null!==(e=null==t?void 0:t.limit)&&void 0!==e?e:this.limit,r=await VirgoUtils.fetchData(CatalogData.virgoCatalogPoolURL,CatalogData.catalogLinkBase,this.query,i+1);return r.meta.url=`https://search.lib.virginia.edu/?q=${this.query}&pool=uva_library`,this.items=r.items,this.meta=r.meta,r}}CatalogData.virgoCatalogPoolURL="https://pool-solr-ws-uva-library.internal.lib.virginia.edu/api/search",CatalogData.catalogLinkBase="https://search.lib.virginia.edu/sources/uva_library/items";class ArticlesData extends GeneralData{constructor(){super(...arguments),this.items=[]}async fetchData(t){var e;const i=null!==(e=null==t?void 0:t.limit)&&void 0!==e?e:this.limit,r=await VirgoUtils.fetchData(ArticlesData.articlePoolURL,ArticlesData.articleLinkBaseURL,this.query,i);return r.meta.url=`https://search.lib.virginia.edu/?q=keyword:+{${this.query}}&pool=articles`,this.items=r.items,this.meta=r.meta,r}}ArticlesData.articlePoolURL="https://pool-eds-ws.internal.lib.virginia.edu/api/search",ArticlesData.articleLinkBaseURL="https://search.lib.virginia.edu/sources/articles/items";export{ArticlesData as A,CatalogData as C,DataWrap as D,GeneralData as G,Document as a};

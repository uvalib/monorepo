import{_ as e,n as t}from"./query-assigned-elements-8ef6cca7.js";import{D as s}from"./document-77724c06.js";import{B as i,r as n}from"./BentoSection-42015d06.js";import"./lit-element-9e1ac43c.js";import"./unsafe-html-9171da0a.js";import"./SiteStyle-35a18246.js";class r{constructor(){this.filenames=[],this.indexType="flexsearch"}async loadFromString(e){const t=JSON.parse(e);if(this.indexType=t.indexType,this.filenames=t.filenames,"flexsearch"===this.indexType){console.log("document:"),console.log(s),this.index=new s({document:{id:"id",index:["content"],store:["title","year"]}});for(let e in t.index)this.index.import(e,t.index[e])}else if("fuse"===this.indexType){const e=await import("./fuse.esm-5b73a1ca.js");this.index=new e.default(t.index,{keys:["text"]})}}performSearch(e){let t=[];if("flexsearch"===this.indexType){console.log(this.index);const s=this.index.search(e,{enrich:!0});console.log(s),t=s.flatMap((e=>e.result)),console.log(t)}else"fuse"===this.indexType&&(t=this.index.search(e).map((e=>e.refIndex)));return console.log(t),t.map((e=>this.filenames[e.id]))}}class o extends i{constructor(){super(...arguments),this.searchLib=new r,this.staticIndexURL="/demo/searchIndex.json",this.loading=!0}async firstUpdated(){try{const e=await fetch(this.staticIndexURL),t=await e.text();await this.searchLib.loadFromString(t),this.loading=!1}catch(e){console.error(`Error loading search index: ${e}`),this.loading=!1}}updated(e){super.updated(e),e.has("query")&&this.performSearch()}performSearch(){console.log("Attempt a search"),this.query?this.items=this.searchLib.performSearch(this.query):this.items=[]}renderBriefItem(e){return n({link:e.filename,title:e.title,description:e.year})}render(){return super.render()}}e([t({type:Boolean})],o.prototype,"loading",void 0),window.customElements.define("client-search-section",o);

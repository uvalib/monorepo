import{_ as e,n as t}from"./property-8648e151.js";import{D as i}from"./document-77724c06.js";import{B as s,r}from"./BentoSection-7c57d088.js";import"./lit-element-ab109411.js";import"./unsafe-html-e63196f7.js";import"./SiteStyle-ee7ab697.js";class n{constructor(){this.filenames=[],this.indexType="flexsearch"}async loadFromString(e){const t=JSON.parse(e);if(this.indexType=t.indexType,this.filenames=t.filenames,"flexsearch"===this.indexType){console.log("document:"),console.log(i),this.index=new i({document:{id:"id",index:["content"],store:["title","year"]}});for(let e in t.index)this.index.import(e,t.index[e])}else if("fuse"===this.indexType){const e=await import("./fuse.esm-5b73a1ca.js");this.index=new e.default(t.index,{keys:["text"]})}}performSearch(e){let t=[];if("flexsearch"===this.indexType){console.log(this.index);const i=this.index.search(e,{enrich:!0});console.log(i),t=i.flatMap((e=>e.result)),console.log(t)}else"fuse"===this.indexType&&(t=this.index.search(e).map((e=>e.refIndex)));return console.log(t),t.map((e=>this.filenames[e.id]))}}class o extends s{constructor(){super(...arguments),this.searchLib=new n,this.staticIndexURL="/demo/searchIndex.json",this.loading=!0}async firstUpdated(){try{const e=await fetch(this.staticIndexURL),t=await e.text();await this.searchLib.loadFromString(t),this.loading=!1}catch(e){console.error(`Error loading search index: ${e}`),this.loading=!1}}updated(e){super.updated(e),e.has("query")&&this.performSearch()}performSearch(){console.log("Attempt a search"),this.query?this.items=this.searchLib.performSearch(this.query):this.items=[]}renderBriefItem(e){return r({link:e.filename,title:e.title,description:e.year})}render(){return super.render()}}e([t({type:Boolean})],o.prototype,"loading",void 0),window.customElements.define("client-search-section",o);

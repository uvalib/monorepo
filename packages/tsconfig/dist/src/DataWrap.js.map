{"version":3,"file":"DataWrap.js","sourceRoot":"","sources":["../../../data-wrap/src/DataWrap.ts"],"names":[],"mappings":";AAAA,sDAAsD;AACtD,OAAO,EAAE,UAAU,EAAE,MAAM,KAAK,CAAC;AACjC,OAAO,EAAE,QAAQ,EAAE,MAAM,mBAAmB,CAAC;AAE7C,MAAM,OAAO,QAAS,SAAQ,UAAU;IAAxC;;QAEiC,SAAI,GAAG,KAAK,CAAC;IAkC9C,CAAC;IAtBG,YAAY;QACR,sCAAsC;QACtC,OAAO,CAAC,GAAG,CAAC,wBAAwB,CAAC,CAAA;QACrC,IAAI,IAAI,CAAC,GAAG,EAAE;YACV,MAAM,GAAG,GAAG,IAAI,GAAG,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;YAC9B,IAAI,IAAI,CAAC,MAAM;gBACX,KAAK,MAAM,CAAC,CAAC,EAAC,CAAC,CAAC,IAAI,MAAM,CAAC,OAAO,CAAC,IAAI,CAAC,MAAM,CAAC,EAAE;oBAC7C,GAAG,CAAC,YAAY,CAAC,GAAG,CAAC,CAAC,EAAC,CAAC,CAAC,CAAC;iBAC7B;YACL,KAAK,CAAC,GAAG,CAAC,QAAQ,EAAE,CAAC,CAAC,IAAI,CAAC,CAAC,CAAA,EAAE,CAAA,CAAC,CAAC,IAAI,EAAE,CAAC,CAAC,IAAI,CAAC,CAAC,CAAA,EAAE,GAAC,IAAI,CAAC,YAAY,GAAG,CAAC,CAAA,CAAA,CAAC,CAAC,CAAC;YACzE,IAAI,IAAI,CAAC,IAAI;gBAAE,UAAU,CAAC,GAAE,EAAE,GAAE,IAAI,CAAC,YAAY,EAAE,CAAC,CAAA,CAAC,EAAE,IAAI,CAAC,IAAI,CAAC,CAAA;SACpE;IACL,CAAC;IAED,OAAO,CAAC,iBAAuC;QAC3C,IAAI,IAAI,CAAC,IAAI,EAAE;YACX,IAAI,iBAAiB,CAAC,GAAG,CAAC,MAAM,CAAC,IAAI,iBAAiB,CAAC,GAAG,CAAC,KAAK,CAAC,IAAI,iBAAiB,CAAC,GAAG,CAAC,QAAQ,CAAC,IAAI,iBAAiB,CAAC,GAAG,CAAC,MAAM,CAAC;gBACjI,IAAI,CAAC,YAAY,EAAE,CAAC;SAC3B;QACD,IAAI,IAAI,CAAC,YAAY;YAAE,IAAI,CAAC,aAAa,CAAC,IAAI,KAAK,CAAC,UAAU,EAAE,EAAC,OAAO,EAAE,IAAI,EAAE,QAAQ,EAAE,IAAI,EAAC,CAAC,CAAC,CAAA;IACrG,CAAC;CAEJ;AAlCgC;IAA5B,QAAQ,CAAC,EAAE,IAAI,EAAE,OAAO,EAAE,CAAC;sCAAc;AAEd;IAA3B,QAAQ,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,CAAC;qCAAyB;AAExB;IAA3B,QAAQ,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,CAAC;wCAA4B;AAEI;IAA1D,QAAQ,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,SAAS,EAAE,mBAAmB,EAAC,CAAC;kDAAsC;AAErE;IAA1B,QAAQ,CAAC,EAAE,IAAI,EAAE,MAAM,EAAC,CAAC;sCAA0B;AAExB;IAA3B,QAAQ,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,CAAC;8CAAkC","sourcesContent":["/* eslint-disable @typescript-eslint/no-unused-vars */\nimport { LitElement } from 'lit';\nimport { property } from 'lit/decorators.js';\n\nexport class DataWrap extends LitElement {\n\n    @property({ type: Boolean }) auto = false;\n\n    @property({ type: String }) url: string | undefined;\n\n    @property({ type: Object }) params: Object | undefined;\n\n    @property({ type: Number, attribute: \"debounce-duration\"}) debounceDuration: Number | undefined;\n\n    @property({ type: Number}) poll: number | undefined;\n\n    @property({ type: Object }) lastResponse: Object | undefined;\n\n    fetchResults() {\n        // eslint-disable-next-line no-console\n        console.log(\"call to fetch results!\")       \n        if (this.url) {\n            const url = new URL(this.url);\n            if (this.params)\n                for (const [k,v] of Object.entries(this.params)) {\n                    url.searchParams.set(k,v);\n                }\n            fetch(url.toString()).then(r=>r.json()).then(d=>{this.lastResponse = d});\n            if (this.poll) setTimeout(()=> {this.fetchResults();}, this.poll)\n        }\n    }\n\n    updated(changedProperties: Map<string, unknown>) {\n        if (this.auto) {\n            if (changedProperties.has('auto') || changedProperties.has('url') || changedProperties.has('params') || changedProperties.has('poll')) \n                this.fetchResults();\n        }\n        if (this.lastResponse) this.dispatchEvent(new Event('response', {bubbles: true, composed: true}))\n    }\n\n}\n\n\n"]}